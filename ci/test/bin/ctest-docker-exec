set -e
env | grep CTEST
CUDA_VISIBLE_DEVICES=$(echo ${CTEST_RESOURCE_GROUP_0} | sed "s/cuda//g" | sed "s/cpu,//g" | sed "s/,cpu//g" | sed "s/cpu//g")
[ -z "$CUDA_VISIBLE_DEVICES" ] && echo "CUDA_VISIBLE_DEVICES empty, setting it to -1" && CUDA_VISIBLE_DEVICES=-1
set -x
if [ -z "$RUN_IN_DOCKER" ]
then
    $@
else
    docker exec \
        -e ONEFLOW_TEST_CPU_ONLY=${ONEFLOW_TEST_CPU_ONLY} \
        -e ONEFLOW_TEST_DEVICE_NUM=${ONEFLOW_TEST_DEVICE_NUM} \
        -e CUDA_VISIBLE_DEVICES=${CUDA_VISIBLE_DEVICES} "$@"
fi
